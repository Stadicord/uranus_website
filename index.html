<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Terrell Effect æ¨¡æ“¬å™¨</title>

  <!-- å­—é«”èˆ‡æ¨£å¼ -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Noto Sans TC', sans-serif;
      background: radial-gradient(ellipse at bottom, #001133 0%, #000000 100%);
      color: #fff;
      overflow-x: hidden;
    }
    header, footer {
      text-align: center;
      padding: 1em;
    }
    .lang-buttons button, #perspectiveBtn {
      margin: 0 5px;
      padding: 5px 10px;
      font-size: 1rem;
      border-radius: 5px;
      border: none;
      background-color: #333;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }
    .lang-buttons button:hover, #perspectiveBtn:hover {
      background-color: #555;
    }
    .controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 10px;
    }
    .controls label {
      margin-bottom: 5px;
    }
    .canvas-container {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 30px;
      padding: 20px;
    }
    canvas {
      width: 300px;
      height: 300px;
      background: #111;
      border: 1px solid #444;
    }
    #explanation {
      max-width: 900px;
      margin: 20px auto;
      padding: 0 20px;
      font-size: 1rem;
      line-height: 1.8;
      text-align: left;
    }
  </style>

  <!-- MathJax for LaTeX rendering -->
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <!-- Three.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.148.0/build/three.min.js"></script>
</head>
<body>
  <header>
    <h1 id="title">ç‰¹å‹’çˆ¾æ•ˆæ‡‰æ¨¡æ“¬å™¨</h1>
    <div class="lang-buttons">
      <button onclick="setLang('zh-TW')">ğŸ‡¹ğŸ‡¼ ç¹é«”ä¸­æ–‡</button>
      <button onclick="setLang('en')">ğŸ‡ºğŸ‡¸ English</button>
      <button id="perspectiveBtn" onclick="togglePerspective()">å•Ÿç”¨é€è¦–æ¨¡å¼</button>
    </div>
    <div class="controls">
      <label id="betaLabel">Î² = 0.00</label>
      <input type="range" id="betaSlider" min="0" max="0.99" step="0.01" value="0.00">
    </div>
  </header>

  <main class="canvas-container">
    <div>
      <canvas id="lorentzCanvas"></canvas>
      <p id="lorentzDesc">æ´›å€«èŒ²æ”¶ç¸®ç¤ºæ„</p>
    </div>
    <div>
      <canvas id="terrellCanvas"></canvas>
      <p id="terrellDesc">ç‰¹å‹’çˆ¾è¦–è¦ºæ•ˆæ‡‰ç¤ºæ„</p>
    </div>
  </main>

  <footer>
    <div id="explanation">
      Lorentz æ”¶ç¸®ï¼šè€ƒæ…®ä¸€æ£’å­é•·åº¦ç‚º $L_0$ï¼Œåœ¨è§€æ¸¬è€…ç³»ä¸­ä»¥é€Ÿåº¦ $v$ æ²¿ $x$ è»¸é‹å‹•ã€‚å› äº‹ä»¶åŒæ™‚æ€§çš„é‡æ–°å®šç¾©ï¼Œè§€å¯Ÿåˆ°çš„é•·åº¦ç‚ºï¼š
      $$L = L_0\sqrt{1 - \beta^2}$$
      é€™æ˜¯æ´›å€«èŒ²è½‰æ›å°è‡´çš„é•·åº¦æ”¶ç¸®ã€‚
      <br><br>
      Terrell æ•ˆæ‡‰ï¼šç”±æ–¼å…‰çš„æœ‰é™å‚³æ’­é€Ÿåº¦ï¼Œè§€å¯Ÿè€…æ‰€çœ‹åˆ°çš„å½±åƒæ˜¯ä¾†è‡ªç‰©é«”ä¸åŒä½ç½®çš„å…‰ç·šï¼Œåœ¨ä¸åŒæ™‚é–“ç™¼å‡ºã€åŒæ™‚æŠµé”è§€å¯Ÿè€…ï¼Œé€™ç”¢ç”Ÿäº†ä¸€ç¨®é¡ä¼¼æ–¼æ—‹è½‰çš„è¦–è¦ºéŒ¯è¦ºã€‚
      å¯¦éš›ä¸Šç‰©é«”æ²’æœ‰æ—‹è½‰ï¼Œè€Œæ˜¯å…‰åˆ°é”æ™‚é–“çš„çµ„åˆéŒ¯è¦ºé€ æˆçš„ã€‚
      <br><br>
      è‹¥è€ƒæ…®ä¸€éœæ­¢ç«‹æ–¹é«”åœ¨ä»¥é€Ÿåº¦ $\beta$ æ¥è¿‘è§€å¯Ÿè€…æ™‚ï¼Œå®ƒçš„å¯è¦‹é‚Šç·£æœƒå½·å½¿æ—‹è½‰äº†è§’åº¦ $\theta = \sin^{-1}(\beta)$ï¼Œé€™å°±æ˜¯æ‰€è¬‚çš„ "Terrell rotation"ã€‚
    </div>
  </footer>

  <script>
    let lang = 'zh-TW';
  let perspectiveEnabled = false;
  
  const scenes = {};
  const renderers = {};
  const cameras = {};
  const cubes = {};
  const lights = {};
  const edges = {};
  
  function initScene(canvasId, isLorentz) {
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById(canvasId), antialias: true });
    renderer.setSize(300, 300);
  
    const geometry = new THREE.BoxGeometry(1, 1, 1);
    const material = new THREE.MeshStandardMaterial({ color: isLorentz ? 0x00aaff : 0xff8844 });
    const cube = new THREE.Mesh(geometry, material);
    scene.add(cube);
  
    const edgeGeo = new THREE.EdgesGeometry(geometry);
    const edgeLines = new THREE.LineSegments(edgeGeo, new THREE.LineBasicMaterial({ color: 0xffffff, linewidth: 2 }));
    cube.add(edgeLines);
  
    camera.position.z = 3;
  
    scenes[canvasId] = scene;
    renderers[canvasId] = renderer;
    cameras[canvasId] = camera;
    cubes[canvasId] = cube;
    edges[canvasId] = edgeLines;
  }
  
  function animate() {
    requestAnimationFrame(animate);
    for (const id in scenes) {
      if (id === 'lorentzCanvas') {
        const cube = cubes[id];
        cube.rotation.y += 0.01;
        cube.rotation.x += 0.005;
      }
      renderers[id].render(scenes[id], cameras[id]);
    }
  }
  
  function updateBeta(beta) {
    document.getElementById("betaLabel").innerText = `Î² = ${beta.toFixed(2)}`;
  
    // Lorentz Contraction
    const lorentzCube = cubes['lorentzCanvas'];
    lorentzCube.scale.x = Math.sqrt(1 - beta * beta);
  
    // Terrell Effect - simulate apparent rotation (simplified)
    const theta = Math.asin(beta);
    const terrellCube = cubes['terrellCanvas'];
    terrellCube.rotation.y = theta;
  }
  
  function setLang(code) {
    lang = code;
    const text = {
      "zh-TW": {
        title: "ç‰¹å‹’çˆ¾æ•ˆæ‡‰æ¨¡æ“¬å™¨",
        lorentzDesc: "æ´›å€«èŒ²æ”¶ç¸®ç¤ºæ„",
        terrellDesc: "ç‰¹å‹’çˆ¾è¦–è¦ºæ•ˆæ‡‰ç¤ºæ„",
        explanation: `Lorentz æ”¶ç¸®ï¼šè€ƒæ…®ä¸€æ£’å­é•·åº¦ç‚º \( L_0 \)ï¼Œåœ¨è§€æ¸¬è€…ç³»ä¸­ä»¥é€Ÿåº¦ \( v \) æ²¿ \( x \) è»¸é‹å‹•ã€‚å› äº‹ä»¶åŒæ™‚æ€§çš„é‡æ–°å®šç¾©ï¼Œè§€å¯Ÿåˆ°çš„é•·åº¦ç‚ºï¼š\\[ L = L_0\sqrt{1 - \beta^2} \\]é€™æ˜¯æ´›å€«èŒ²è½‰æ›å°è‡´çš„é•·åº¦æ”¶ç¸®ã€‚<br><br>Terrell æ•ˆæ‡‰ï¼šç”±æ–¼å…‰çš„æœ‰é™å‚³æ’­é€Ÿåº¦ï¼Œè§€å¯Ÿè€…æ‰€çœ‹åˆ°çš„å½±åƒæ˜¯ä¾†è‡ªç‰©é«”ä¸åŒä½ç½®çš„å…‰ç·šï¼Œåœ¨ä¸åŒæ™‚é–“ç™¼å‡ºã€åŒæ™‚æŠµé”è§€å¯Ÿè€…ï¼Œé€™ç”¢ç”Ÿäº†ä¸€ç¨®é¡ä¼¼æ–¼æ—‹è½‰çš„è¦–è¦ºéŒ¯è¦ºã€‚å¯¦éš›ä¸Šç‰©é«”æ²’æœ‰æ—‹è½‰ï¼Œè€Œæ˜¯å…‰åˆ°é”æ™‚é–“çš„çµ„åˆéŒ¯è¦ºé€ æˆçš„ã€‚<br><br>è‹¥è€ƒæ…®ä¸€éœæ­¢ç«‹æ–¹é«”åœ¨ä»¥é€Ÿåº¦ \( \beta \) æ¥è¿‘è§€å¯Ÿè€…æ™‚ï¼Œå®ƒçš„å¯è¦‹é‚Šç·£æœƒå½·å½¿æ—‹è½‰äº†è§’åº¦ï¼š\\[\theta = \sin^{-1}(\beta)\\]é€™å°±æ˜¯æ‰€è¬‚çš„ Terrell rotationã€‚`,
        perspective: "å•Ÿç”¨é€è¦–æ¨¡å¼",
        perspective_off: "é—œé–‰é€è¦–æ¨¡å¼"
      },
      "en": {
        title: "Terrell Effect Simulator",
        lorentzDesc: "Lorentz Contraction",
        terrellDesc: "Terrell Visual Effect",
        explanation: `Lorentz contraction: For a rod of rest length \( L_0 \) moving at velocity \( v \) along the \( x \) axis, simultaneity shift causes observed length to be: \\[ L = L_0\sqrt{1 - \beta^2} \\]<br><br>Terrell Effect: Because light from different parts of the object reaches the observer at different times, the composite image appears rotated. In reality, the object does not rotate; the appearance is due to timing.<br><br>For a cube moving at velocity \( \beta \), it appears rotated by angle: \\[\theta = \sin^{-1}(\beta)\\]called the Terrell rotation.`,
        perspective: "Enable Perspective Mode",
        perspective_off: "Disable Perspective Mode"
      }
    };
  
    document.getElementById("title").innerText = text[code].title;
    document.getElementById("lorentzDesc").innerText = text[code].lorentzDesc;
    document.getElementById("terrellDesc").innerText = text[code].terrellDesc;
    document.getElementById("explanation").innerHTML = text[code].explanation;
    document.getElementById("perspectiveBtn").innerText = perspectiveEnabled ? text[code].perspective_off : text[code].perspective;
    MathJax.typeset();
  }
  
  function togglePerspective() {
    perspectiveEnabled = !perspectiveEnabled;
    for (const id in cubes) {
      const cube = cubes[id];
      const mat = cube.material;
      mat.transparent = perspectiveEnabled;
      mat.opacity = perspectiveEnabled ? 0.4 : 1;
      mat.wireframe = perspectiveEnabled;
      edges[id].material.linewidth = perspectiveEnabled ? 4 : 2;
    }
    setLang(lang); // refresh button text
  }
  
  // Init
  initScene("lorentzCanvas", true);
  initScene("terrellCanvas", false);
  animate();
  
  // Events
  betaSlider.addEventListener("input", e => updateBeta(parseFloat(e.target.value)));
  setLang("zh-TW");
  </script>
</body>
</html>
